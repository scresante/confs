# tmux.conf

# set prefix to a
unbind -n C-b
unbind -n C-a
set -g prefix ^A
set -g prefix2 ^A
bind a send-prefix

# ctrl+a, hold control, hjkl to resize
bind -r C-l resize-pane -R
bind -r C-h resize-pane -L
bind -r C-j resize-pane -D
bind -r C-k resize-pane -U

# reload tmux config
unbind r
bind r \
    source-file ~/.tmux.conf \;\
    display 'Reloaded tmux config.'

# MOUSE
unbind m
bind m set mouse on
unbind M
bind M set mouse off
set -g mouse on

set-option -g history-limit 1000000
set -g mode-keys vi

# start windows from 1, not 0
set -g base-index 1

set-window-option -g automatic-rename on
setw -g monitor-activity on

set -s escape-time 0

set -g default-terminal "screen-256color"
set -ga terminal-overrides ",$TERM:Tc"

# STATUSLINE(POWERLINE) CONFIG
run-shell "pgrep -f powerline-daemon > /dev/null|| powerline-daemon -q"
if-shell 'env "$POWERLINE_CONFIG_COMMAND" tmux setup' '' 'run-shell "powerline-config tmux setup"'
set -g status-interval 5

# navigation with C-{h,j,k,l} -- NO PREFIX
# https://gist.github.com/mislav/5189704
bind -n C-k select-pane -U
bind -n C-j select-pane -D
bind -n C-h select-pane -L
bind -n C-l select-pane -R

# change prefix-l from lastwin to clear
unbind l
bind l send-keys -R C-l

# shift-pgup automatically enters copy-mode
bind -T root -n S-Pageup copy-mode -u

set -g set-clipboard on

# these two options may be mutually exclusive
setw -g aggressive-resize on
set -g window-size smallest
#./tmux -L test new-session -factive-pane -s aux -t main


####################################################
### CUSTOM MOUSE WHEEL SCROLLING FOR LEGACY APPS ###
####################################################

#tmux_commands_with_legacy_scroll="nano less more man git"

#bind-key -T root WheelUpPane \
	#if-shell -Ft= '#{?mouse_any_flag,1,#{pane_in_mode}}' \
		#'send -Mt=' \
		#'if-shell -t= "#{?alternate_on,true,false} || echo \"#{tmux_commands_with_legacy_scroll}\" | grep -q \"#{pane_current_command}\"" \
			#"send -t= Up Up Up" "copy-mode -et="'

#bind-key -T root WheelDownPane \
	#if-shell -Ft = '#{?pane_in_mode,1,#{mouse_any_flag}}' \
		#'send -Mt=' \
		#'if-shell -t= "#{?alternate_on,true,false} || echo \"#{tmux_commands_with_legacy_scroll}\" | grep -q \"#{pane_current_command}\"" \
			#"send -t= Down Down Down" "send -Mt="'
